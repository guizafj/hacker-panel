repos:
  # 1. Ruff - Linter y formateador ultrarrÃ¡pido (reemplaza flake8, black, isort)
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.6.9  # Actualizada a versiÃ³n mÃ¡s reciente
    hooks:
      - id: ruff
        name: "ðŸ” Ruff Linter"
        args: [--fix, --exit-non-zero-on-fix, --show-fixes]
        types_or: [python, pyi, jupyter]
      - id: ruff-format
        name: "ðŸŽ¨ Ruff Formatter"
        types_or: [python, pyi, jupyter]

  # 2. Hooks bÃ¡sicos de pre-commit
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: trailing-whitespace
        name: "âœ‚ï¸  Eliminar espacios en blanco finales"
      - id: end-of-file-fixer
        name: "ðŸ“„ Corregir final de archivo"
      - id: check-yaml
        name: "ðŸ“‹ Validar sintaxis YAML"
        args: [--unsafe]  # Permite tags de Docker Compose
      - id: check-json
        name: "ðŸ”§ Validar sintaxis JSON"
      - id: check-toml
        name: "âš™ï¸  Validar sintaxis TOML"
      - id: check-xml
        name: "ðŸŒ Validar sintaxis XML"
      - id: check-merge-conflict
        name: "ðŸ”€ Detectar conflictos de merge"
      - id: check-case-conflict
        name: "ðŸ“ Detectar conflictos de mayÃºs/minÃºs"
      - id: check-added-large-files
        name: "ðŸ“¦ Detectar archivos grandes"
        args: ['--maxkb=1000']  # Archivos > 1MB
      - id: mixed-line-ending
        name: "â†©ï¸  Normalizar finales de lÃ­nea"
        args: ['--fix=lf']  # Forzar LF (Unix)

  # 3. Seguridad - Detectar secretos y problemas de seguridad
  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.5.0
    hooks:
      - id: detect-secrets
        name: "ðŸ” Detectar secretos/credenciales"
        args: ['--baseline', '.secrets.baseline']
        exclude: |
          (?x)^(
            .*\.env\.example|
            .*\.env\.dev\.example|
            .*/migrations/.*\.py|
            .*test.*\.py|
            .*\.secrets\.baseline
          )$

  # 4. Seguridad Python - Bandit
  - repo: https://github.com/PyCQA/bandit
    rev: '1.7.10'
    hooks:
      - id: bandit
        name: "ðŸ›¡ï¸  AnÃ¡lisis de seguridad Python"
        args: ['-c', 'pyproject.toml']
        additional_dependencies: ['bandit[toml]']
        exclude: |
          (?x)^(
            .*/migrations/.*\.py|
            .*/tests/.*\.py|
            .*/test_.*\.py
          )$

  # 5. ValidaciÃ³n de dependencias (opcional)
  - repo: local
    hooks:
      - id: requirements-check
        name: "ðŸ“‹ Verificar requirements.txt actualizado"
        entry: bash -c 'echo "âœ… Requirements verificados - ejecutar pip-audit manualmente para seguridad"'
        language: system
        files: requirements.*\.txt$
        pass_filenames: false

  #   # 6. DocumentaciÃ³n - Validar docstrings (configuraciÃ³n relajada)
  # - repo: https://github.com/pycqa/pydocstyle
  #   rev: 6.3.0
  #   hooks:
  #     - id: pydocstyle
  #       name: "ðŸ“š Validar docstrings"
  #       args: [--convention=google, --add-ignore=D100,D101,D102,D103,D104,D105,D106,D107]
  #       exclude: |
  #         (?x)^(
  #           .*/migrations/.*\.py|
  #           .*/tests/.*\.py|
  #           .*/test_.*\.py|
  #           manage\.py|
  #           .*/settings\.py|
  #           .*/urls\.py|
  #           .*/__init__\.py|
  #           .*/forms\.py|
  #           .*/models\.py|
  #           .*/admin\.py|
  #           .*/views\.py
  #         )$

  # 7. AuditorÃ­a de dependencias - Verificar vulnerabilidades
  - repo: https://github.com/pypa/pip-audit
    rev: v2.9.0
    hooks:
      - id: pip-audit
        entry: .venv/bin/pip-audit
        args: ['--desc']
        additional_dependencies: ['pip>=25.3']